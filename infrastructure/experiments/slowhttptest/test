slowhttptest -c 1000 -H -u http://192.168.0.2:80/ -g -o apache_1s -i 10 -r 50 -s 4096 -l 180

Apache KeepAlive 1s, 5s, 10s, 30s

slowhttptest -c 10000 -H -u http://192.168.0.2:80/ -g -o apache_1s -i 10 -r 200 -s 4096 -l 240
5s Apache, roundrobin
Haproxy 1, 2, 3 uzly
Nginx 1,2, 3 uzly

pi@malina:/etc/haproxy $ vnstat --traffic                                                                             
3375 packets sampled in 5 seconds                                                                                     
Traffic average for eth0                                                                                              
                                                                                                                      
      rx       356,58 kbit/s           602 packets/s                                                                 
      tx        50,39 kbit/s            72 packets/s                                                                 
      
pi@raspberrypi:~ $ vnstat --traffic
1727 packets sampled in 5 seconds
Traffic average for eth0
    rx       137.81 kbit/s           175 packets/s
    tx       126.41 kbit/s           170 packets/s
      
      
      PING 192.168.0.2 (192.168.0.2) 56(84) bytes of data.
ping -D -U 192.168.0.2 | tee udp-flood-ping.txt
sudo hping 192.168.0.2 --udp --flood

load_module /usr/lib/nginx/modules/ngx_stream_module.so;
user www-data;
worker_processes auto;
pid /run/nginx.pid;
events {
    worker_connections 1024;
}

stream {
log_format basic '$remote_addr [$time_local] '
                 '$protocol $status $bytes_sent $bytes_received '
                 '$session_time';

access_log /var/log/nginx-access.log basic buffer=32k;

    upstream website {
        server 192.168.0.2:80;
        server 192.168.0.3:80;
        server 192.168.0.4:80;
    }

    server {
        listen 8090;
        proxy_pass website;

    }
}

ulimit -a
socket: Too many open files (24)

apr_socket_recv: Connection reset by peer (104)

pridaj workers


nslookup website.home
Server:         192.168.0.2
Address:        192.168.0.2#53

Name:   website.home
Address: 192.168.0.4
Name:   website.home
Address: 192.168.0.2
Name:   website.home
Address: 192.168.0.3

dig website.home                                                        
                                                                                                                      
; <<>> DiG 9.16.12 <<>> website.home                                                                                  
;; global options: +cmd                                                                                               
;; Got answer:                                                                                                        
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 55404                                                             
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 1, ADDITIONAL: 2                                               
                                                                                                                      
;; OPT PSEUDOSECTION:                                                                                                 
; EDNS: version: 0, flags:; udp: 4096                                                                                 
; COOKIE: 8e0437e580565b505b46b369606b342568f0addafd20ef90 (good)
;; QUESTION SECTION:                                       
;website.home.                  IN      A                  
                                                           
;; ANSWER SECTION:                                         
website.home.           86400   IN      A       192.168.0.3
website.home.           86400   IN      A       192.168.0.4
website.home.           86400   IN      A       192.168.0.2
                                                           
;; AUTHORITY SECTION:                                      
home.                   86400   IN      NS      ns.home.   
                                                           
;; ADDITIONAL SECTION:                                     
ns.home.                86400   IN      A       192.168.0.2
                                                           
;; Query time: 3 msec                                      
;; SERVER: 192.168.0.2#53(192.168.0.2)                     
;; WHEN: Po apr 05 18:00:37 CEST 2021                      
;; MSG SIZE  rcvd: 150 

for i in $(seq 0 10); do curl http://website.home > /dev/null; done

for i in $(seq 0 10); do curl -v --head http://website.home; done
for i in $(seq 0 10); do curl -v --head http://website.home > dns-log.txt; done
